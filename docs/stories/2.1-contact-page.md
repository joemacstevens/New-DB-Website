# Story 2.1: Contact & Visit Page Build

Status: Ready for Review

## Story
**As a** frontend engineer,  
**I want** to implement the `/contact` page with form, map, and social touchpoints,  
**so that** visitors can reach the gym quickly and convert through clear CTAs.

## Acceptance Criteria
1. `/contact` renders hero, contact form + info column, map/visit section, social links panel, and closing CTA bar per handoff layout.
2. Contact form integrates with configured provider (Formspree/Resend), validates inputs, surfaces success/error states, and emits `data-cta` metrics for submissions.
3. Contact info block and map embed present confirmed phone/email/address/hours, provide working Call and Get Directions links, and include sticky mobile "Get Day Pass" CTA.
4. All CTAs (Get Day Pass, Call Now, Visit Us, Social links) apply design tokens, remain accessible across breakpoints, and capture `data-cta` attributes for analytics.

## Tasks / Subtasks
- [x] Build `/contact` route using shared layout primitives and Hero/CTAbar components (AC 1, AC 4)
  - [x] Configure hero copy, background media, and dual CTA buttons with analytics attributes (AC 1, AC 4)
- [x] Implement `ContactForm` component with validation, success/error handling, and provider integration driven by env config (AC 2)
  - [x] Add unit coverage for form validation rules and submission helper (AC 2)
- [x] Create contact info & map sections including Google Maps embed, call/email/directions links, and sticky mobile CTA behaviour (AC 1, AC 3)
  - [x] Ensure map iframe meets accessibility requirements (title, fallback text) and lazy loads appropriately (AC 3)
- [x] Build social links panel with accessible icon buttons and analytics instrumentation (AC 1, AC 4)
- [x] Update documentation (README or `/docs`) with instructions for configuring Formspree/Resend keys and map embed URL (AC 2, AC 3)

## Dev Notes
- Reference `page_plan/contact_visit_page_different_breed.md` for copy, section order, and CTA intent.
- Coordinate with ops to confirm Formspree endpoint and Google Maps embed URL; wire via environment variables with preview/prod variants.
- Sticky bottom CTA should only appear on mobile breakpoints (`<768px`) and respect reduced motion settings.
- Reuse design tokens from Story 1.5 and CTA primitives from Stories 1.6–1.7; extend previews under `/preview` if helpful for UX review.
- Ensure social links open in new tab with `rel="noopener"` and include descriptive `aria-label`s.

### Testing
- Unit test form validation helpers and analytics data payloads.
- Manual QA: submit form (using test endpoint), verify success/error states, confirm CTA links and sticky button behaviour on mobile emulator.
- Run `pnpm lint`, `pnpm test`, and `pnpm build` to protect regressions.

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2025-02-17 | v0.1 | Initial draft created from Sprint 2 ticket S2-1 | PM |

## Dev Agent Record
### Agent Model Used
OpenAI GPT-5 (Codex)


### Debug Log References
- pnpm test
- pnpm build


### Completion Notes List
- Created `/contact` page composition with hero, sticky mobile CTA, CTA bar, and responsive section scaffolding.
- Added environment-driven `ContactForm` component backed by shared validation helpers and analytics instrumentation including sticky CTA metrics.
- Implemented `/api/contact` server handler that validates submissions and proxies to Formspree with user-friendly success/error redirects.
- Implemented contact info, map, and social sections with accessible markup, CTA coverage, and configuration fallbacks when env vars are missing.
- Documented required environment variables in `README.md` and added unit tests for validation helpers.


### File List

- src/pages/contact.astro
- src/pages/api/contact.ts
- src/components/ContactForm.astro
- src/components/ContactInfo.astro
- src/components/MapSection.astro
- src/components/SocialLinks.astro
- src/styles/contact.module.css
- src/utils/contactValidation.ts
- tests/unit/contact-validation.test.ts
- README.md

## QA Results
- 2025-10-20 (Quinn, QA) – **PASS**: `/contact` renders hero, form/info column, map, socials, and CTA bar with instrumented CTAs; form submission flows through `/api/contact` with validation/errors/success states; contact info exposes clickable call/email/directions links plus sticky mobile CTA; README captures env variables for Formspree and Google Maps configuration.
